<html>

<head>

	<meta http-equiv="Access-Control-Allow-Origin" content="*">
	<link rel="stylesheet" type="text/css" href="mystyle.css">
	<script src="http://ajax.aspnetcdn.com/ajax/jQuery/jquery-1.6.2.min.js"></script>
	<script type="text/javascript">
	var req = new XMLHttpRequest();
	var url = "http://localhost:8080/LibPrint/RequestHandler?request=listQueue";
	var myList;

	
	function callOtherDomain() {
		if ('withCredentials' in req) {
	    req.open('GET', url, true);
	    // Just like regular ol' XHR
	    req.onreadystatechange = function() {
	        if (req.readyState === 4) {
	            if (req.status >= 200 && req.status < 400) {
	                buildHtmlTable('#excelDataTable');
	            } else {
	                // Handle error case
	            }
	        }
	    };
	    req.send();
	}
	}
	//http://stackoverflow.com/questions/5180382/convert-json-data-to-a-html-table
	//var myList = [
	//  { "name": "abc", "age": 50 },
	//  { "age": "25", "hobby": "swimming" },
	//  { "name": "xyz", "hobby": "programming" }
	//];
	
	
	// Builds the HTML Table out of myList.
	function buildHtmlTable(selector) {
		$.getJSON(url, function(result){
			myList = result.queue;
	        var columns = addAllColumnHeaders(myList, selector);
	
	    	for (var i = 0; i < myList.length; i++) {
	    		var row$ = $('<tr/>');
	    		for (var colIndex = 0; colIndex < columns.length; colIndex++) {
	    			var cellValue = myList[i][columns[colIndex]];
	    			if (cellValue == null) cellValue = "";
	    			row$.append($('<td/>').html(cellValue));
	    		}
	    		row$.append($('<td/>').html("<button onclick='acceptPrint(1);'/>"));
	    		$(selector).append(row$);
	    	}
	    });
	}
	
	
	// Adds a header row to the table and returns the set of columns.
	// Need to do union of keys from all records as some records may not contain
	// all records.
	function addAllColumnHeaders(myList, selector) {
		var columnSet = [];
		var headerTr$ = $('<tr/>');
	
		for (var i = 0; i < myList.length; i++) {
			var rowHash = myList[i];
			for (var key in rowHash) {
				if ($.inArray(key, columnSet) == -1) {
				columnSet.push(key);
				headerTr$.append($('<th/>').html(key));
				}
			}
		}
		$(selector).append(headerTr$);
		return columnSet;
	}
	</script>
	<title>LibPrint Administration Page</title>
</head>

<body onLoad="callOtherDomain()">
	<h1>LibPrint JQuery Tests</h1>
    <br></br>
	
	<a href="https://en.wikipedia.org/wiki/User_(computing)" class="button">  Edit Users  </a>
	<a href="http://www.bestbuy.com/site/office-electronics/printers/abcat0511001.c?id=abcat0511001" class="button">  Edit Printers  </a>
	 &emsp; &emsp; &emsp; &emsp;
	<a href="http://www.logout.com/" class="button">  Logout  </a> Micah Richards<br></br>
	
	<form>
		<fieldset>
		<legend>Active Printers:</legend>
		<div align="left">
			Color &emsp; &emsp; &emsp; &emsp;
			<input type="radio" name="group1" value="Milk"> Active
			<input type="radio" name="group1" value="Butter" checked> Maintenance
			&emsp; &emsp; &emsp; &emsp; &emsp; &emsp; &emsp; &emsp;
			<form method="get" action="RequestHandler">
			<input type="hidden" name="secToken" value="temp"/>
			<input type="hidden" name="request" value="listSystemPrinters"/>
			<input type="submit"/>
			</form>
			Black and White &nbsp;
			<input type="radio" name="group1" value="Milk"> Active
			<input type="radio" name="group1" value="Butter" checked> Maintenance<br>
			</div>
		</fieldset>
	</form>
	Print Queue 
	<button id="refresh" onclick="callOtherDomain()">Refresh</button> 
	</br></br></br>
	<table id="excelDataTable" border="1">
    </table>
	</br></br></br>
	<table style="width:100%">
  <tr>
    <th>Time</th>
    <th>Username</th> 
    <th>Document</th>
    <th>Computer</th>
    <th>Printer</th>
    <th>Pages</th>
    <th>Total</th>
    <th colspan="2">Options</th>
  </tr>
   <tr>
    <th>5:31 PM</th>
    <th>chandlergriscom</th> 
    <th>SRS.doc</th>
    <th>S1</th>
    <th>Bland and White</th>
    <th>5</th>
    <th>Free</th>
    <th><a href="https://www.google.com/cloudprint/learn/" class="button"> Print </a></th>
	<th><a href="https://www.merriam-webster.com/dictionary/cancel" class="button"> Cancel </a></th>
  </tr>
   <tr>
    <th>5:30 PM</th>
    <th>LibraryGuest2</th> 
    <th>Grocery List.txt</th>
    <th>P2</th>
    <th>Color</th>
    <th>4</th>
    <th>$2.00</th>
    <th><a href="https://www.google.com/cloudprint/learn/" class="button"> Print </a></th>
	<th><a href="https://www.merriam-webster.com/dictionary/cancel" class="button"> Cancel </a></th>
  </tr>
</table>
<br><br>
History
<table style="width:100%">
   <tr>
    <th>Time</th>
    <th>Username</th> 
    <th>Document</th>
    <th>Computer</th>
    <th>Printer</th>
    <th>Pages</th>
    <th>Total</th>
    <th>Printed</th>
  </tr>
  <tr>
    <th>5:25 PM</th>
    <th>dillonhartsfield</th> 
    <th>MarsAssignment.doc</th>
    <th>S5</th>
    <th>Black and White</th>
    <th>1</th>
    <th>Free</th>
	<th> 5:27 PM</th>
  </tr>
  <tr>
   <th>5:20 PM</th>
    <th>joshpowell</th> 
    <th>phonebook.html</th>
    <th>S10</th>
    <th>Black and White</th>
    <th>251</th>
    <th>Free</th>
    <th>Canceled</th>
  </tr>
</table>
</body>

</html>
